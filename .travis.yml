language: java
jdk:
  - oraclejdk8
os:
- linux
- osx
osx_image: xcode9.3
before_install:
  - chmod +x gradlew
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
script:
  - "./gradlew assemble"
  - "./gradlew clean check -Dmockserver.logLevel=ERROR"
after_success:
- bash <(curl -s https://codecov.io/bash)
branches:
  except:
  - gh-pages
  - docs
before_deploy:
  - "./gradlew jfxNative"

deploy:
  - provider: releases
    api_key:
      secure: iby59j05wSn1l1Y02mJ+lgfCKh5GPzPE6ICW6IrYoU3FPsu4+Pl61b+XEykhJZEXuRKIpWLCiepg2iU4XlnLN+CQS/jIEgvXPkuuyhcxUz58YVC20SauikOSJzNt9rmHDzhv0mnUgzgcdxdVIUo8wQd0C4FP/9GNZfj5yFjdwD8SkfCSnTISS9zz16X+ucbXXqCnyBwRdUL2Cgoe5DVXKAFxDDiFD5KJUmgbPMFWnlsMF9/7n/DrKedgtpwsBht+uX/Ub7bUTPeNOuqMhvbZNRrNKG+t3P5JoNrd2HIDhXs730QZyUyGuuPmlTPdyKIWsBZbwLE2Hx+Cf4hJQ/uXxYnxPo+T8oKSYXLJCpBllFK7qRoKoBArWsjmAEaq70FllshEvDCij3JX+yN5n11O5xsv3rYeP52jFgbqJo8vIG8h1rcLQIERqNn2ySZwJaJ8hmegTQLYFzLYufmzFgO2hBwI7Jjsy0PDDLtifZLKqMMQ8iGSukQJO0zP/CN5f/1l+Zvkho6raPILigC+7MzVyL66A03X+5cdBU/XScb5vGS+ru8Xcqr3iq2RWpuxj24V12ayVxMR4wKWcr7aetTWLjQ5ReP5WblAkp6dL7i2lfiu4126cEBdIFoLlJQ9mYZLzhNPaVsSRnXpc2KFXgOLxsmst/3JBpVpyZmXnm0l7Og=
    skip_cleanup: true
    file: "build/jfx/native/octopusdownloader-*.app"
    on:
      condition: $TRAVIS_OS_NAME = osx
      branch: release
      tags: true

  - provider: releases
    api_key:
      secure: iby59j05wSn1l1Y02mJ+lgfCKh5GPzPE6ICW6IrYoU3FPsu4+Pl61b+XEykhJZEXuRKIpWLCiepg2iU4XlnLN+CQS/jIEgvXPkuuyhcxUz58YVC20SauikOSJzNt9rmHDzhv0mnUgzgcdxdVIUo8wQd0C4FP/9GNZfj5yFjdwD8SkfCSnTISS9zz16X+ucbXXqCnyBwRdUL2Cgoe5DVXKAFxDDiFD5KJUmgbPMFWnlsMF9/7n/DrKedgtpwsBht+uX/Ub7bUTPeNOuqMhvbZNRrNKG+t3P5JoNrd2HIDhXs730QZyUyGuuPmlTPdyKIWsBZbwLE2Hx+Cf4hJQ/uXxYnxPo+T8oKSYXLJCpBllFK7qRoKoBArWsjmAEaq70FllshEvDCij3JX+yN5n11O5xsv3rYeP52jFgbqJo8vIG8h1rcLQIERqNn2ySZwJaJ8hmegTQLYFzLYufmzFgO2hBwI7Jjsy0PDDLtifZLKqMMQ8iGSukQJO0zP/CN5f/1l+Zvkho6raPILigC+7MzVyL66A03X+5cdBU/XScb5vGS+ru8Xcqr3iq2RWpuxj24V12ayVxMR4wKWcr7aetTWLjQ5ReP5WblAkp6dL7i2lfiu4126cEBdIFoLlJQ9mYZLzhNPaVsSRnXpc2KFXgOLxsmst/3JBpVpyZmXnm0l7Og=
    skip_cleanup: true
    file: "build/jfx/native/octopusdownloader-*.deb"
    on:
      condition: $TRAVIS_OS_NAME = linux
      branch: release
      tags: true